<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å˜èªå¸³</title>
<style>
body{margin:0;font-family:sans-serif;background:#eef2ff}
header{background:#191970;color:white;padding:10px;display:flex;justify-content:space-between;align-items:center}
main{max-width:900px;margin:30px auto;text-align:center}
button{background:#191970;color:white;border:none;border-radius:10px;padding:10px 18px;margin:5px;font-size:16px;cursor:pointer}
.card{background:white;padding:25px;border-radius:12px}
.list{background:white;margin-top:20px;padding:20px;border-radius:12px}
.wordbook{padding:10px;border-bottom:1px solid #ddd;display:flex;justify-content:space-between}
a{text-decoration:none;color:#191970;font-weight:bold}
html, body{height:100%;margin:0;}
body{display:flex;flex-direction:column;background:#eef2ff;}
main{flex:1;max-width:1000px;margin:30px auto;text-align:center;}
footer{background:#191970;color:white;padding:15px 0;}
.footer-inner{max-width:1000px;margin:auto;text-align:center;}
.footer-links a{color:white;margin:0 10px;text-decoration:none;font-weight:bold;}
.footer-links a:hover{text-decoration:underline;}
.copy{font-size:12px;opacity:0.8;}
</style>
</head>
<body>

<header>
  <div id="status">ãƒ­ã‚°ã‚¤ãƒ³ç¢ºèªä¸­...</div>
  <div>
    <button id="mypageBtn" style="display:none" onclick="goPage('mypage.html')">ãƒã‚¤ãƒšãƒ¼ã‚¸</button>
    <button id="loginBtn" onclick="location.href='login.html'">ãƒ­ã‚°ã‚¤ãƒ³</button>
    <button id="logoutBtn" style="display:none" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
  </div>
</header>

<main>
  <div class="card">
    <h1>å˜èªå¸³ã‚¢ãƒ—ãƒª</h1>
    <button onclick="goPage('create.html')">â• ä½œæˆ</button>
    <button onclick="goPage('list.html')">ğŸ“š ä¸€è¦§</button>
  </div>

  <div id="myBooks" class="list" style="display:none">
    <h2>ğŸ“– è‡ªåˆ†ã®å˜èªå¸³</h2>
    <div id="bookList"></div>
  </div>
</main>

<footer>
  <div class="footer-inner">
    <div>ğŸ“˜ å˜èªå¸³ã‚¢ãƒ—ãƒª</div>
    <div class="footer-links">
      <a href="#" onclick="goPage('index.html')">ãƒ›ãƒ¼ãƒ </a>
      <a href="#" onclick="goPage('list.html')">å…¬é–‹å˜èªå¸³</a>
      <a href="#" onclick="goPage('create.html')">ä½œæˆ</a>
      <a href="#" onclick="goPage('mypage.html')">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
      <a href="#" onclick="goPage('update.html')">æ›´æ–°å±¥æ­´</a>
    </div>
    <div class="copy">Â© 2026 Wordbook App</div>
  </div>
</footer>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyD7CJmO3eAO0o2EPRDsVqTtZ_whRd_3-3E",
  authDomain: "quiz1-4ffdc.firebaseapp.com",
  projectId: "quiz1-4ffdc",
  storageBucket: "quiz1-4ffdc.firebasestorage.app",
  messagingSenderId: "152062126332",
  appId: "1:152062126332:web:845af237a1a76207214f79"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

const statusDiv = document.getElementById("status");
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const mypageBtn = document.getElementById("mypageBtn");
const myBooksDiv = document.getElementById("myBooks");
const bookListDiv = document.getElementById("bookList");

let currentUser = null;

auth.onAuthStateChanged(user=>{
  currentUser = user;
  if(user){
    statusDiv.textContent = "ãƒ­ã‚°ã‚¤ãƒ³ä¸­: " + user.uid;
    loginBtn.style.display="none";
    logoutBtn.style.display="inline-block";
    mypageBtn.style.display="inline-block";
    loadMyBooks(user.uid);
  }else{
    statusDiv.textContent = "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆä¸­";
    loginBtn.style.display="inline-block";
    logoutBtn.style.display="none";
    mypageBtn.style.display="none";
    myBooksDiv.style.display="none";
  }
});

function goPage(page){
  if(page === "index.html"){
    location.href = "index.html";
    return;
  }
  if(currentUser){
    location.href = page;
  }else{
    alert("ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„");
    location.href = "login.html";
  }
}

function logout(){
  auth.signOut();
}

function loadMyBooks(uid){
  db.collection("wordbooks")
    .where("owner","==",uid)
    .get()
    .then(snapshot=>{
      bookListDiv.innerHTML="";
      myBooksDiv.style.display="block";

      if(snapshot.empty){
        bookListDiv.innerHTML="<p>ã¾ã å˜èªå¸³ãŒã‚ã‚Šã¾ã›ã‚“</p>";
        return;
      }

      snapshot.forEach(doc=>{
        const data = doc.data();
        const div = document.createElement("div");
        div.className="wordbook";
        div.innerHTML = `
          <span>${data.title}</span>
          <a href="view.html?id=${doc.id}">é–‹ã</a>
        `;
        bookListDiv.appendChild(div);
      });
    })
    .catch(err=>{
      alert("èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: "+err.message);
    });
}
</script>

</body>
</html>



